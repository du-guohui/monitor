global.webpackJsonp([8],{"5vTQ":function(t,e,i){"use strict";var a=i("mvHQ"),s=i.n(a),n=(i("G/BZ"),i("FmT9")),o=i.n(n),r=i("2FZb"),c=i("olkN"),l=i("0xDb");o.a.Util.addEventListener=function(t,e,i){t.addListener(e,i)},o.a.Util.removeEventListener=function(t,e,i){t.removeListener(e,i)},o.a.Util.createEvent=function(t,e){var i=t.type,a=0,s=0,n=t.touches;return n&&n.length>0&&(a=n[0].x,s=n[0].y),{type:i,chart:e,x:a,y:s}},e.a={computed:{Loading:function(){return c.a.state.Loading},DeviceList:function(){return c.a.state.Data.Device},DeviceLength:function(){return c.a.state.Data.DeviceLength},DeviceOl:function(){return c.a.state.Data.DeviceOl},AlarmList:function(){return c.a.state.Data.Alarm},AlarmLength:function(){return c.a.state.Data.Alarm.filter(function(t){return!t.is_recovered}).length}},data:function(){return{Group:"",GroupList:[],weatherData:"",opts:{lazyLoad:!0},data0:[],data1:[],data2:[],SelectBox:!1,change:!1,load:!0}},methods:{Select:function(){var t=this;t.SelectBox=!0,Object(r.d)("#wux-select").open({value:t.Group.id,options:t.GroupList,onConfirm:function(e,i,a){-1!==i&&(t.Group={id:e,title:a[i].title},t.GetData()),t.SelectBox=!1},onCancel:function(){t.SelectBox=!1}})},initChart:function(t,e,i){var a=null,s=[],n=[],r=[],c=this.DeviceList,l=0;for(var u in c)l+=c[u].device_list.length;for(var h in c)s.push({name:c[h].group.name,a:"1",percent:c[h].device_list.length/l}),n.push(c[h].group.name),r.push((c[h].device_list.length/l*100).toFixed(1)+"%");var v=new Object;for(var d in n)v[n[d]]=r[d];return(a=new o.a.Chart({el:t,width:e,height:i})).source(s,{percent:{formatter:function(t){return(100*t).toFixed(1)+"% , 设备数量："+t*l}}}),a.legend({position:"right",itemFormatter:function(t){return t+"  "+v[t]}}),a.coord("polar",{transposed:!0,radius:.85}),a.axis(!1),a.interval().position("a*percent").color("name",["#1890FF","#13C2C2","#2FC25B","#FACC14","#F04864","#8543E0"]).adjust("stack").style({lineWidth:1,stroke:"#fff",lineJoin:"round",lineCap:"round"}).animate({appear:{duration:1200,easing:"bounceOut"}}),a.render(),a},initChart2:function(t,e,i){var a=null,s={time:{type:"timeCat",mask:"MM-DD"},value:{tickCount:5,alias:"",formatter:function(t){return""==t?"":Number(t).toFixed(1)+"°C"}}};return(a=new o.a.Chart({el:t,width:e,height:i})).source(this.data1,s),a.axis("time",{label:function(t,e,i){var a={};return 0===e?a.textAlign="left":e===i-1&&(a.textAlign="right"),a}}),a.tooltip({showCrosshairs:!0}),a.area().position("time*value").color("type").shape("type",function(t){}),a.line().position("time*value").color("type"),a.render(),a},initChart3:function(t,e,i){var a=null;return(a=new o.a.Chart({el:t,width:e,height:i})).source(this.data2,{time:{type:"timeCat",mask:"MM-DD"},value:{tickCount:5,alias:"",formatter:function(t){return""==t?"":t.toFixed(1)+"%"}}}),a.axis("time",{label:function(t,e,i){var a={};return 0===e?a.textAlign="left":e===i-1&&(a.textAlign="right"),a}}),a.tooltip({showCrosshairs:!0}),a.area().position("time*value").color("type").shape("type",function(t){}),a.line().position("time*value").color("type"),a.render(),a},Weather:function(){var t=this;wx.getLocation({type:"wgs84",success:function(e){var i=e.latitude,a=e.longitude;wx.request({url:"https://free-api.heweather.net/s6/weather/now?key=HE1901231004001149",data:{location:i+","+a},success:function(e){t.weatherData=e.data.HeWeather6[0]}})}})},GetData:function(){var t=this;!this.load&&"{}"!=s()(this.Group)&&this.DeviceLength>"0"?this.Group.id?(this.data1=[],this.data2=[],this.ajax("device/getDeviceContinuousDataPacketByGroup",{group_id:this.Group.id,period:7,res_type:"avg"}).then(function(e){if(e.length>"0")for(var i in e){var a=e[i].continuousData;for(var s in a){var n=Object(l.a)(a[s],s,e[i].name).filter(function(t){return"temperature"==t.types&&"avg"==t.res});t.data1.push(n[0]);var o=Object(l.a)(a[s],s,e[i].name).filter(function(t){return"humidity"==t.types&&"avg"==t.res});t.data2.push(o[0])}}t.$mp.page.selectComponent("#column1").init(t.initChart)})):this.$mp.page.selectComponent("#column1").init(this.initChart):setTimeout(function(){t.GetData()},400)},ToAlarm:function(){wx.switchTab({url:"/pages/alarm/index"})}},mounted:function(){this.Weather()},onShow:function(){this.data1=[],this.data2=[],this.GetData()},watch:{data1:function(){var t=this;this.data1.length>"0"&&setTimeout(function(){t.$mp.page.selectComponent("#column3").init(t.initChart3),t.$mp.page.selectComponent("#column2").init(t.initChart2)},300)},Loading:function(){var t=this,e=this;this.$route&&(this.$wuxLoading=Object(r.c)(),this.Loading?this.$wuxLoading.show({text:"数据加载中"}):setTimeout(function(){t.$wuxLoading.hide()},800)),this.Loading?e.load=!0:setTimeout(function(){e.load=!1},800)},DeviceList:function(){if(this.Group="",this.GroupList=[],this.DeviceList.length>"0")for(var t in this.DeviceList)this.DeviceList[t].device_list.length>"0"&&(this.GroupList.push({value:this.DeviceList[t].group.id,title:this.DeviceList[t].group.name}),"0"==this.Group.length&&(this.Group={id:this.DeviceList[t].group.id,title:this.DeviceList[t].group.name}))}}}},"748/":function(t,e,i){"use strict";var a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container mtt"},[""!=t.weatherData?i("div",{staticClass:"index-weather"},[i("div",{staticClass:"city"},[i("img",{attrs:{src:"/static/img/15.png",alt:""}}),t._v("\n      "+t._s(t.weatherData.basic.parent_city)+"\n    ")]),t._v(" "),t.weatherData?i("div",{staticClass:"humidity"},[i("img",{attrs:{src:"/static/img/16.png",alt:""}}),t._v("\n      "+t._s(t.weatherData.now.hum)+"%\n    ")]):t._e(),t._v(" "),t.weatherData?i("div",{staticClass:"temperature"},[i("img",{attrs:{src:"/static/img/17.png",alt:""}}),t._v("\n      "+t._s(t.weatherData.now.tmp)+"°C\n    ")]):t._e()]):t._e(),t._v(" "),i("div",{staticClass:"index-shebei"},[i("div",{staticClass:"title color1"},[t._v("设备概览")]),t._v(" "),i("wux-row",{attrs:{mpcomid:"3"}},[i("wux-col",{attrs:{span:"4",mpcomid:"0"}},[i("div",{staticClass:"li"},[i("div",{staticClass:"txt"},[t._v(t._s(t.DeviceLength))]),t._v(" "),i("div",{staticClass:"txt2"},[t._v("设备数")])])]),t._v(" "),i("wux-col",{attrs:{span:"4",mpcomid:"1"}},[i("div",{staticClass:"li"},[i("div",{staticClass:"txt"},[t._v(t._s(t.DeviceOl))]),t._v(" "),i("div",{staticClass:"txt2"},[t._v("在线设备")])])]),t._v(" "),i("wux-col",{attrs:{span:"4",mpcomid:"2"}},[i("div",{staticClass:"li",attrs:{eventid:"0"},on:{click:t.ToAlarm}},[i("div",{staticClass:"txt",class:{red:t.AlarmLength>"0"}},[t._v(t._s(t.AlarmLength))]),t._v(" "),i("div",{staticClass:"txt2",class:{red:t.AlarmLength>"0"}},[t._v("报警")])])])],1)],1),t._v(" "),i("div",{staticClass:"echarts-li",staticStyle:{"min-height":"280px"}},[i("div",{staticClass:"title color1"},[t._v("设备分布")]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.SelectBox,expression:"!SelectBox"}],staticClass:"echarts-wrap",staticStyle:{height:"200px"}},[i("ff-canvas",{attrs:{id:"column1","canvas-id":"column1",opts:t.opts,mpcomid:"4"}})],1)]),t._v(" "),i("div",{staticClass:"echarts-li"},[i("div",{staticClass:"title color1"},[t._v("\n      "+t._s(t.Group.title)+"一周温度\n      "),i("wux-icon",{staticClass:"ioc",attrs:{type:"ios-more",size:"26",color:"#cccccc",eventid:"1",mpcomid:"5"},on:{click:t.Select}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.SelectBox,expression:"!SelectBox"}],staticClass:"echarts-wrap",style:{height:t.data1.length+220+"px"}},[i("ff-canvas",{attrs:{id:"column2","canvas-id":"column2",opts:t.opts,mpcomid:"6"}})],1)]),t._v(" "),i("div",{staticClass:"echarts-li"},[i("div",{staticClass:"title color1"},[t._v("\n      "+t._s(t.Group.title)+"一周湿度\n      "),i("wux-icon",{staticClass:"ioc",attrs:{type:"ios-more",size:"26",color:"#cccccc",eventid:"2",mpcomid:"7"},on:{click:t.Select}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.SelectBox,expression:"!SelectBox"}],staticClass:"echarts-wrap",style:{height:t.data1.length+220+"px"}},[i("ff-canvas",{attrs:{id:"column3","canvas-id":"column3",opts:t.opts,mpcomid:"8"}})],1)]),t._v(" "),i("wux-select",{attrs:{id:"wux-select",mpcomid:"9"}}),t._v(" "),i("wux-loading",{attrs:{id:"wux-loading",mpcomid:"10"}})],1)},staticRenderFns:[]};e.a=a},A2un:function(t,e){},Qt9A:function(t,e,i){"use strict";var a=i("5vTQ"),s=i("748/");var n=function(t){i("A2un")},o=i("ybqe")(a.a,s.a,n,"data-v-7b2e018c",null);e.a=o.exports}},["r576"]);