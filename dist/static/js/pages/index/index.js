global.webpackJsonp([7],{"5vTQ":function(t,e,i){"use strict";i("G/BZ");var a=i("FmT9"),s=i.n(a),n=i("2FZb"),r=i("olkN"),c=i("0xDb");s.a.Util.addEventListener=function(t,e,i){t.addListener(e,i)},s.a.Util.removeEventListener=function(t,e,i){t.removeListener(e,i)},s.a.Util.createEvent=function(t,e){var i=t.type,a=0,s=0,n=t.touches;return n&&n.length>0&&(a=n[0].x,s=n[0].y),{type:i,chart:e,x:a,y:s}},e.a={computed:{DeviceList:function(){return r.a.state.DeviceList},AlarmList:function(){return r.a.state.AlarmList}},data:function(){return{DeviceIndex:0,DeviceOl:0,AlarmIndex:0,Group:"",GroupList:[],weatherData:"",opts:{lazyLoad:!0},data0:[],data1:[],data2:[],SelectBox:!1}},methods:{Select:function(){var t=this;t.SelectBox=!0,Object(n.c)("#wux-select").open({value:t.Group.id,options:t.GroupList,onConfirm:function(e,i,a){-1!==i&&(t.Group={id:e,name:a[i].title}),t.SelectBox=!1},onCancel:function(){t.SelectBox=!1}})},initChart:function(t,e,i){var a=null,n=[],r=[],c=[],o=this.DeviceList,l=0;for(var u in o)l+=o[u].device_list.length;for(var v in o)n.push({name:o[v].group.name,a:"1",percent:o[v].device_list.length/l}),r.push(o[v].group.name),c.push(o[v].device_list.length/l*100+"%");var d=new Object;for(var h in r)d[r[h]]=c[h];return(a=new s.a.Chart({el:t,width:e,height:i})).source(n,{percent:{formatter:function(t){return 100*t+"% , 设备数量："+t*l}}}),a.legend({position:"right",itemFormatter:function(t){return t+"  "+d[t]}}),a.coord("polar",{transposed:!0,radius:.85}),a.axis(!1),a.interval().position("a*percent").color("name",["#1890FF","#13C2C2","#2FC25B","#FACC14","#F04864","#8543E0"]).adjust("stack").style({lineWidth:1,stroke:"#fff",lineJoin:"round",lineCap:"round"}).animate({appear:{duration:1200,easing:"bounceOut"}}),a.render(),a},initChart2:function(t,e,i){var a=null,n={time:{type:"timeCat",mask:"MM-DD",tickCount:5},value:{tickCount:6,alias:"",formatter:function(t){return""==t?"":Number(t).toFixed(1)+"°C"}}};return(a=new s.a.Chart({el:t,width:e,height:i})).source(this.data1,n),a.axis("time",{label:function(t,e,i){var a={};return 0===e?a.textAlign="left":e===i-1&&(a.textAlign="right"),a}}),a.tooltip({showCrosshairs:!0}),a.area().position("time*value").color("type").shape("type",function(t){}),a.line().position("time*value").color("type"),a.render(),a},initChart3:function(t,e,i){var a=null;return(a=new s.a.Chart({el:t,width:e,height:i})).source(this.data2,{time:{type:"timeCat",mask:"MM-DD",tickCount:7},value:{tickCount:6,alias:"",formatter:function(t){return""==t?"":t.toFixed(1)+"%"}}}),a.axis("time",{label:function(t,e,i){var a={};return 0===e?a.textAlign="left":e===i-1&&(a.textAlign="right"),a}}),a.tooltip({showCrosshairs:!0}),a.area().position("time*value").color("type").shape("type",function(t){}),a.line().position("time*value").color("type"),a.render(),a},Weather:function(){var t=this;wx.getLocation({type:"wgs84",success:function(e){var i=e.latitude,a=e.longitude;wx.request({url:"https://free-api.heweather.net/s6/weather/now?key=HE1901231004001149",data:{location:i+","+a},success:function(e){t.weatherData=e.data.HeWeather6[0]}})}})},GetData:function(t){var e=this;e.data1=[],e.data2=[],e.ajax("device/getDeviceContinuousDataPacketByGroup",{group_id:e.Group.id,period:7,res_type:"avg"}).then(function(t){if(t.length>"0")for(var i in t){var a=t[i].continuousData;for(var s in a){var n=Object(c.a)(a[s],s,t[i].name).filter(function(t){return"temperature"==t.types&&"avg"==t.res});e.data1.push(n[0]);var r=Object(c.a)(a[s],s,t[i].name).filter(function(t){return"humidity"==t.types&&"avg"==t.res});e.data2.push(r[0])}}e.$mp.page.selectComponent("#column1").init(e.initChart),e.$mp.page.selectComponent("#column2").init(e.initChart2),e.$mp.page.selectComponent("#column3").init(e.initChart3)})}},mounted:function(){this.Weather(),this.DeviceOl>"0"&&this.DeviceList&&(this.Group=this.DeviceList[0].group,this.GetData())},watch:{DeviceList:function(){for(var t in this.DeviceOl=0,this.DeviceIndex=0,this.DeviceList)for(var e in this.DeviceList[t].device_list.length>"0"&&this.GroupList.push({value:this.DeviceList[t].group.id,title:this.DeviceList[t].group.name}),this.DeviceIndex=this.DeviceIndex+this.DeviceList[t].device_list.length,this.DeviceList[t].device_list)""!=this.DeviceList[t].device_list[e].last_upload_date&&(this.DeviceOl=this.DeviceOl+1);this.$route&&"0"==this.data0.length&&"pagesIndexIndex"==this.$route.name&&(this.Group=this.DeviceList[0].group)},AlarmList:function(){this.AlarmIndex=this.AlarmList.filter(function(t){return!t.is_deleted}).length},Group:function(){this.GetData()}}}},"748/":function(t,e,i){"use strict";var a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container mtt"},[""!=t.weatherData?i("div",{staticClass:"index-weather"},[i("div",{staticClass:"city"},[i("img",{attrs:{src:"/static/img/15.png",alt:""}}),t._v("\n      "+t._s(t.weatherData.basic.parent_city)+"\n    ")]),t._v(" "),t.weatherData?i("div",{staticClass:"humidity"},[i("img",{attrs:{src:"/static/img/16.png",alt:""}}),t._v("\n      "+t._s(t.weatherData.now.hum)+"%\n    ")]):t._e(),t._v(" "),t.weatherData?i("div",{staticClass:"temperature"},[i("img",{attrs:{src:"/static/img/17.png",alt:""}}),t._v("\n      "+t._s(t.weatherData.now.tmp)+"°C\n    ")]):t._e()]):t._e(),t._v(" "),i("div",{staticClass:"index-shebei"},[i("div",{staticClass:"title color1"},[t._v("设备概览")]),t._v(" "),i("wux-row",{attrs:{mpcomid:"3"}},[i("wux-col",{attrs:{span:"4",mpcomid:"0"}},[i("div",{staticClass:"li"},[i("div",{staticClass:"txt"},[t._v(t._s(t.DeviceIndex))]),t._v(" "),i("div",{staticClass:"txt2"},[t._v("设备数")])])]),t._v(" "),i("wux-col",{attrs:{span:"4",mpcomid:"1"}},[i("div",{staticClass:"li"},[i("div",{staticClass:"txt"},[t._v(t._s(t.DeviceOl))]),t._v(" "),i("div",{staticClass:"txt2"},[t._v("在线设备")])])]),t._v(" "),i("wux-col",{attrs:{span:"4",mpcomid:"2"}},[i("div",{staticClass:"li"},[i("div",{staticClass:"txt"},[t._v(t._s(t.AlarmIndex))]),t._v(" "),i("div",{staticClass:"txt2"},[t._v("报警")])])])],1)],1),t._v(" "),i("div",{staticClass:"echarts-li"},[i("div",{staticClass:"title color1"},[t._v("设备分布")]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.SelectBox,expression:"!SelectBox"}],staticClass:"echarts-wrap"},[i("ff-canvas",{attrs:{id:"column1","canvas-id":"column1",opts:t.opts,mpcomid:"4"}})],1)]),t._v(" "),i("div",{staticClass:"echarts-li"},[i("div",{staticClass:"title color1",attrs:{eventid:"0"},on:{click:t.Select}},[t._v("\n      "+t._s(t.Group.name)+"一周温度\n      "),i("wux-icon",{staticClass:"ioc",attrs:{type:"ios-more",size:"26",color:"#cccccc",mpcomid:"5"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.SelectBox,expression:"!SelectBox"}],staticClass:"echarts-wrap"},[i("ff-canvas",{attrs:{id:"column2","canvas-id":"column2",opts:t.opts,mpcomid:"6"}})],1)]),t._v(" "),i("div",{staticClass:"echarts-li"},[i("div",{staticClass:"title color1",attrs:{eventid:"1"},on:{click:t.Select}},[t._v("\n      "+t._s(t.Group.name)+"一周湿度\n      "),i("wux-icon",{staticClass:"ioc",attrs:{type:"ios-more",size:"26",color:"#cccccc",mpcomid:"7"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.SelectBox,expression:"!SelectBox"}],staticClass:"echarts-wrap"},[i("ff-canvas",{attrs:{id:"column3","canvas-id":"column3",opts:t.opts,mpcomid:"8"}})],1)]),t._v(" "),i("wux-select",{attrs:{id:"wux-select",mpcomid:"9"}})],1)},staticRenderFns:[]};e.a=a},A2un:function(t,e){},Qt9A:function(t,e,i){"use strict";var a=i("5vTQ"),s=i("748/");var n=function(t){i("A2un")},r=i("ybqe")(a.a,s.a,n,"data-v-7b2e018c",null);e.a=r.exports}},["r576"]);